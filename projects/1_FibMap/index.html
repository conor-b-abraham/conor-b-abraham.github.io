<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> FibMap | Conor B. Abraham </title> <meta name="author" content="Conor B. Abraham"> <meta name="description" content="A tool for analyzing and mapping amyloid fibrils"> <meta name="keywords" content="Conor, Abraham, Molecular Dynamics, Chemistry, Computational Chemistry, Theoretical Chemistry, Boston University, Simulation, Conor Abraham, Conor B. Abraham, Molecular Science, Biophysics"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link defer href="/assets/css/bootstrap-toc.min.css?6f5af0bb9aab25d79b2448143cbeaa88" rel="stylesheet"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://conor-b-abraham.github.io/projects/1_FibMap/"> <script src="/assets/js/theme.js?a5ca4084d3b81624bcfa01156dae2b8e"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>initTheme();</script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Conor</span> B. Abraham </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">Publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">Curriculum Vitae </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Resources <span class="sr-only">(current)</span> </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="row"> <div class="col-sm-3"> <nav id="toc-sidebar" class="sticky-top"></nav> </div> <div class="col-sm-9"> <div class="post"> <header class="post-header"> <h1 class="post-title">FibMap</h1> <p class="post-description">A tool for analyzing and mapping amyloid fibrils</p> </header> <article class="post-content"> <div id="markdown-content"> <div class="row"> <div class="col-sm mt-3 mt-md-0" style="text-align: center;"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/FibMap_Logo-480.webp 480w,/assets/img/fibmap/FibMap_Logo-800.webp 800w,/assets/img/fibmap/FibMap_Logo-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/FibMap_Logo.png" class="img-fluid rounded z-depth-1" width="50%" height="auto" title="FibMap Logo" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>Fibmap is an automated tool for calculating and displaying the intermolecular forces (Salt Bridges, Hydrogen Bonds, and Pi Stacking interactions) within a finite amyloid fibril model from a PDB file or Molecular Dynamics trajectory.</p> <p>Developed by Conor B. Abraham in the Straub Group at Boston University, Department of Chemistry</p> <h2 id="disclaimer">Disclaimer</h2> <p>FibMap is still a work in progress. If you run into any issues please report them <a href="https://github.com/conor-b-abraham/FibMap/issues" rel="external nofollow noopener" target="_blank">here</a>.</p> <h2 id="background-and-motivation">Background and Motivation</h2> <p>Naturally formed amyloid fibrils can be categorized into two groups: (1) Functional amyloid fibrils, such as the premelanosome protein 17 (Pmel17) fibril that enables melanin synthesis, serve many vital biological roles <a href="#references">[1,2]</a>. (2) Pathogenic amyloid fibrils, such as the β-Amyloid (Aβ) fibril of Alzheimer’s Disease and the Serum Amyloid A (SAA) fibril of Systemic AA Amyloidosis, are effective disease-causing agents <a href="#references">[2]</a>. Amyloid fibrils are defined by their elongated and unbranched amyloid scaffold that is composed of cross-β sheet stacked monomers that are parallel (N-terminus to N-terminus and C-terminus to C-terminus) and in-register (residues are aligned with matching residues in adjacent layers) <a href="#references">[2,3]</a>. They can contain one or more parallel stacks of monomers, called protofilaments. The residues that are not a part of the amyloid scaffold make up intrinsically disordered regions at the exterior of the fibril. Despite all containing the amyloid scaffold, a broad variety of amyloid fibril structures have been identified, and individual amyloid proteins can form multiple polymorphs. Such polymorphism has been detected for many pathogenic amyloids <a href="#references">[4–10]</a>.</p> <p>FibMap.py was created to aid the analysis of the evergrowing collection of amyloid fibrils available on the <a href="https://www.rcsb.org/" rel="external nofollow noopener" target="_blank">RCSB PDB Protein Data Bank</a> and to understand commonalities and differences among amyloid fibril polymorphs.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/abstract-480.webp 480w,/assets/img/fibmap/abstract-800.webp 800w,/assets/img/fibmap/abstract-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/abstract.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="FibMap creates maps of the contacts within an amyloid fibril" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 1: FibMap creates an informative figure displaying the residues and key contacts within an amyloid fibril. The image on the left was created using Visual Molecular Dynamics (VMD) [[11]](#references). The shown fibril is the human Serum Amyloid A fibril (<a href="https://doi.org/10.2210/pdb6MST/pdb" rel="external nofollow noopener" target="_blank">PDB 6MST</a>)[<a href="https://conor-b-abraham.github.io/projects/1_FibMap/#references">12</a>]. </div> <h2 id="methodology">Methodology</h2> <h3 id="hydrogen-bonds">Hydrogen Bonds</h3> <p>FibMap uses MDAnalysis’s Hydrogen Bond Analysis tool for calculating hydrogen bonds. Please see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/analysis/hydrogenbonds.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a> for more information.</p> <p>Potential hydrogen bond acceptors and hydrogens are guessed using the atom charge information. An atom whose charge is less than -0.5e is considered a potential acceptor. Atoms with a mass greater than 0.9u and less than 1.1u and a charge greater than 0.3e are considered potential hydrogen bonded hydrogens. Potential hydrogen bond donors are inferred from the list of potential hydrogen bonded hydrogens.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/HBonds-480.webp 480w,/assets/img/fibmap/HBonds-800.webp 800w,/assets/img/fibmap/HBonds-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/HBonds.png" class="img-fluid rounded z-depth-1" width="50%" height="auto" title="Hydrogen Bond Calculation" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 2: Schematic showing angle and distance of a hydrogen bond. For a given set of a potential hydrogen bond donor and hydrogen and a potential hydrogen bond acceptor, the angle and distance must be below their cutoff. </div> <p>Hydrogen bonds are identified from sets of potential hydrogen bonds donors, acceptors, and hydrogens using a donor-acceptor distance cutoff (\(D_{D-A}\), Default: 3.5Å) and a donor-hydrogen-acceptor angle cutoff (\(\theta_{D-H-A}\), Default: 150°) as shown in Figure 2. These cutoffs can be changed from the commandline or with an input file if desired (See <a href="#parameters">Usage: calc: Parameters</a>).</p> <h3 id="salt-bridges">Salt Bridges</h3> <p>FibMap calculates salt bridges by identifying charged residues and calculating the minimum distance between the charged regions on their sidechains. If the minimum distance between a cation and an anion is below the distance cutoff (Default: 4Å) it is counted as a salt bridge (Figure 3). The distance cutoff for a salt bridge can be changed from the commandline or with an input file if desired (See <a href="#parameters">Usage: calc: Parameters</a>).</p> <p>Determination of charged residues capable of forming salt bridges can be done manually or automatically. The salt bridge group determination method and its associated parameters can be set from the commandline or with an input file (See <a href="#parameters">Usage: calc: Parameters</a>). If done manually, the user can select the residue names and atom names they want to include in the calculation. The default names for manual determination are based on the CHARMM36 force field atom and residue names and are set to include aspartic acid and glutamic acid as anions and lysine, arginine, and basic histidine as cations (Table 1).</p> <p>| Type | Residue | Residue Name(s) | Atom Names | |:—:|:—:|:—:|:—:| | Anion | Aspartic Acid | ASP | OD1, OD2 | | Anion | Glutamic Acid | GLU | OE1, OE2 | | Cation | Lysine | LYS | NZ | | Cation | Arginine | ARG | NH1, NH2, NE | | Cation | Basic Histidine | HSP | ND1, NE2 |</p> <div class="caption"> Table 1: Default residue and atom names used for the manual salt bridge group selector mode. </div> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/SaltBridgeAuto-480.webp 480w,/assets/img/fibmap/SaltBridgeAuto-800.webp 800w,/assets/img/fibmap/SaltBridgeAuto-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/SaltBridgeAuto.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Salt Bridge group Automatic Determination" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 3: Schematic showing the automatic salt bridge group determination method and distances. For lysine (left), the overall charge of the NH<sub>3</sub> group is 0.69e. Because this is the largest charge on the lysine sidechain, the NZ atom will be used as a reference point. For aspartic acid (right) the OD1 and OD2 atoms each carry a -0.76e charge. Assuming this is below the anion charge cutoff, both atoms will be used as reference points. As aspartic acid has 2 reference points and lysine has 1 reference point, two distances are computed. At least one of these distances must be below the salt bridge distance cutoff for it to count as a salt bridge. </div> <p>If done automatically, charged residues are identified using the atom charges in the topology. Then, for each heavy atom in a charged residue, the total charge of that atom and any connected hydrogens is computed (Figure 3). For anions, if the total charge is less than the charge cutoff (Default: -0.5e), the heavy atom is added to the charged region for that atom. For cations, if the total charge is greater than the charge cutoff (Default: 0.5e), the heavy atom is added to the charged region for that atom. If no heavy atom meets the cutoff requirement for an acidic or basic residue, the heavy atom closest to the cutoff will be used and a warning will be thrown.</p> <h3 id="pi-stacking-interactions">Pi Stacking Interactions</h3> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/PiStacking-480.webp 480w,/assets/img/fibmap/PiStacking-800.webp 800w,/assets/img/fibmap/PiStacking-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/PiStacking.png" class="img-fluid rounded z-depth-1" width="30%" height="auto" title="Pi Stacking Determination" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 4: Various measures used in finding and categorizing pi stacking interactions. Based on Fig. 2 from Zhao et al. (2015) [[13]](#references). </div> <p>To calculate pi-stacking interactions, FibMap follows the methodology developed by Zhao et al. <a href="#references">[13]</a>. For the ring of each phenylalanine, tyrosine, histidine, and tryptophan residue, we define its normal vector (\(\mathbf{n_i}\)), ring plane vector (\(\mathbf{r_i}\)), and centroid (Figure 4). Then, for each pair of rings, we calculate their centroid-centroid distance (\(\mathrm{R_{cen}}\)), the acute angle between the centroid-centroid vector and \(\mathbf{r_1}\) (\(\theta\)), the acute angle between the centroid-centroid vector and \(\mathbf{r_2}\), and the acute angle between \(\mathbf{n_1}\) and \(\mathbf{n_2}\) (Figure 4).</p> <p>Any pair with \(\mathrm{R_{cen}} \leq 7.2\) Å could be a pi stacking interaction, so we define its type (Figure 5). If \(\theta \lt 30^{\circ}\) and \(\delta \lt 30^{\circ}\), its a spurious interaction (not a pi stacking interaction). If \(\gamma \lt 50^{\circ}\), it’s a T-shaped pi stacking interaction. If \(30^{\circ} \leq \gamma \leq 50^{\circ}\), it’s an intermediate pi stacking interaction. If \(\gamma \lt 30^{\circ}\) and either \(\theta \gt 80^{\circ}\) or \(\delta \gt 80^{\circ}\), its a sandwich pi stacking interaction. If \(\gamma \lt 30^{\circ}\) and neither \(\theta \gt 80^{\circ}\) nor \(\delta \gt 80^{\circ}\), its a parallel displaced pi stacking interaction.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/PiStackingTypes-480.webp 480w,/assets/img/fibmap/PiStackingTypes-800.webp 800w,/assets/img/fibmap/PiStackingTypes-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/PiStackingTypes.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Pi Stacking Types" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 5: The three main types of pi stacking interactions (Sandwich, T-Shaped, and Parallel Displaced). Intermediate pi stacking interactions (not shown) are between Sandwich and T-Shaped geometry. Based on Fig. 1 from Zhao et al. (2015) [[13]](#references). </div> <p>At this time, the calculation of pi stacking interactions depends upon residue and atom names. In the future, I would like to completely remove naming dependence from the program, but for now this is the only part of the program that still relies on it. By default, the program uses the CHARMM36 forcefield residue and atom names (Table 2). These names can be changed from the commandline or using an input file (See <a href="#parameters">Usage: calc: Parameters</a>).</p> <table> <thead> <tr> <th style="text-align: left">Residue</th> <th style="text-align: center">Residue Name(s)</th> <th style="text-align: right">Atom Names</th> </tr> </thead> <tbody> <tr> <td style="text-align: left">Phenylalanine</td> <td style="text-align: center">PHE</td> <td style="text-align: right">CG, CD2, CE2, CZ, CE1, CD1</td> </tr> <tr> <td style="text-align: left">Tyrosine</td> <td style="text-align: center">TYR</td> <td style="text-align: right">CG, CD2, CE2, CZ, CE1, CD1</td> </tr> <tr> <td style="text-align: left">Histidine</td> <td style="text-align: center">HSD, HSE, HSP</td> <td style="text-align: right">CG, CD2, NE2, CE1, ND1</td> </tr> <tr> <td style="text-align: left">Tryptophan</td> <td style="text-align: center">TRP</td> <td style="text-align: right">CG CD1, NE1, CE2, CD2</td> </tr> </tbody> </table> <div class="caption"> Table 2: The default residue and atom names used to select the aromatic rings that could participate in a pi stacking interaction. *NOTE: Notice that the 5-membered ring (not the 6-membered ring) is used for Tryptophan. This follows the guidance of Zhao et al (2015) [[13]](#references).* </div> <h3 id="probabilities">Probabilities</h3> <p>The goal with calculating the probabilities (or average number of) a given type of interaction within the fibril is to have the probability reflect that of an infinite fibril.</p> <p><em>NOTE: For pi stacking interactions, the processed results file will contain values for</em> \({P(Sandwich)}\)<em>,</em> \(P(T-Shaped)\)<em>,</em> \(P(Intermediate)\)<em>, and</em> \(P(Parallel \text{ } Displaced)\)<em>, as well as,</em> \(P(Total)\)<em>.</em> \(P(Sandwich)\)<em>,</em> \(P(T-Shaped)\)<em>,</em> \(P(Intermediate)\)<em>, and</em> \(P(Parallel \text{ } Displaced)\) <em>are computed after</em> \(P(Total)\) <em>(i.e. they tell you the probability that the pi stacking interaction is of that kind IF it exists). The probability cutoff for displaying a pi stacking interaction on the FibMap is only applied to</em> \(P(Total)\)<em>.</em></p> <h4 id="interlayer-interactions">Interlayer Interactions</h4> <p>For interlayer interactions, this means that the probabilties need to be adjusted to reflect the fact that in a finite fibril model (such as the Cryo-EM structures deposited on the PDB databank), the terminal layers of the fibril are unable to form the interaction. We also have to consider that in our FibMap representation, sidechains are represented by a single point, so for some sites and types of interactions multiple interactions may occur (e.g. Arginine sidechains can form multiple hydrogen bonds). Finally, because the layers of some fibrils are ‘staggered’, interlayer interactions involving a given layer could occur between that layer and multiple other layers. For example, consider two sites, A and B, on a 4 layer fibril (Figure 6).</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/ProbsSingle-480.webp 480w,/assets/img/fibmap/ProbsSingle-800.webp 800w,/assets/img/fibmap/ProbsSingle-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/ProbsSingle.png" class="img-fluid rounded z-depth-1" width="30%" height="auto" title="Interlayer Figure" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 6: Two interaction sites on a four layer fibril forming two different interlayer interactions. </div> <p>On the FibMap, we will be representing two different interactions with the same representation, an \(A_{i}\text{ }to\text{ }B_{i+1}\) interaction and an \(A_{i}\text{ }to\text{ }B_{i+2}\) interaction. When calculating this probability we have to account for the fact that a maximum of 3 \(A_{i}\text{ }to\text{ }B_{i+1}\) interactions can occur and a maximum of 2 \(A_{i}\text{ }to\text{ }B_{i+2}\) interactions can occur. We also have to account for the fact that in the case that a single interaction does not occur, it does not necessarily change the overall probability of an \(A_{i}\text{ }to\text{ }B_{j \neq i}\) interaction (e.g. if \(A_{4}\text{ }to\text{ }B_{3}\) does not occur, but the probability of an \(A_{i}\text{ }to\text{ }B_{i+2}\) is 1, then the overall probability of an \(A_{i}\text{ }to\text{ }B_{j \neq i}\) interaction is still 1). So, the overall probability of an \(A_{i}\text{ }to\text{ }B_{j \neq i}\) interaction at a given timestep, \(f\), is given by:</p> \[p_{A_{i} \text{ } to \text{ } B_{j \neq i}}(f) = \mathrm{max} \left\lbrace p_{A_{i} \text{ } to \text{ } B_{i+1}}(f), \text{ } p_{A_{i} \text{ } to \text{ } B_{i+2}}(f), \text{ } p_{A_{i} \text{ } to \text{ } B_{i+1, i+2}}(f) \right\rbrace,\] <p>where \(p_{A_{i} \text{ } to \text{ } B_{i+1}}(f)\) is the probability that eligible sites are bound by an \(A_{i} \text{ } to \text{ } B_{i+1}\) interaction, \(p_{A_{i} \text{ } to \text{ } B_{i+2}}(f)\) is the probability that eligible sites are bound by an \(A_{i} \text{ } to \text{ } B_{i+2}\) interaction, and \(p_{A_{i} \text{ } to \text{ } B_{i+1, i+2}}(f)\) is the probability that elibile sites are bound by either an \(A_{i} \text{ } to \text{ } B_{i+1}\) interaction or an \(A_{i} \text{ } to \text{ } B_{i+2}\) interaction. We compute these subprobabilities by considering the number of sites involved in each interaction rather than by considering the number of interactions themselves, allowing us to extrapolate to an infinite fibril. These subprobabilities are given by:</p> \[p_{A_i \text{ } to \text{ } B_{i + \Delta \ell}}(f) = \frac{n_{s,bound}}{n_{s,eligible}},\] <p>where \(n_{s,eligible}=2(n_{layers}-\Delta \ell)\) is the number of eligible interaction sites given the fibril model (e.g. for the above example, \(n_{s,eligible}=6$ for $p_{A_{i} \text{ } to \text{ } B_{i+1}}(f)\), \(n_{s,eligible}=4\) for \(p_{A_{i} \text{ } to \text{ } B_{i+2}}(f)\), and \(n_{s,eligible}=6\) for \(p_{A_{i} \text{ } to \text{ } B_{i+1,i+2}}(f)\)). Here, \(\Delta \ell\) is the number of layers spanned by a given subtype (e.g. \(\Delta \ell (A_{i} \text{ } to \text{ } B_{i+1}) = 1\) and \(\Delta \ell (A_{i} \text{ } to \text{ } B_{i+2}) = 2\)), or the minimum \(\Delta \ell\) for the combined subprobability (e.g. \(\Delta \ell (A_{i} \text{ } to \text{ } B_{i+1, i+2}) = 1\)), and \(n_{layers}\) is the total number of layers in the fibril. \(n_{s, bound}\) is the number of those sites involved in a given interaction (or in either interaction for the combined subprobability). We then take the ensemble average of the overall probability at each frame for each interaction:</p> \[P(A_i \text{ } to \text{ } B_{j\neq i})=\frac{1}{n_{f}}\sum_f^{n_f} p_{A_{i} \text{ } to \text{ } B_{j \neq i}}(f).\] <p>For Hydrogen Bonds, since more than one may form between a pair of sites, you also have the option to use a average number of interactions, \(\langle N_{HB} \rangle\) cutoff for the FibMap. For an individual frame, the average number of interactions for a given pair of interaction sites is given by:</p> \[N_{A_i \text{ } to \text{ } B_{j\neq i}}(f) = \frac{2(n_{interactions})}{n_{s, weighted}},\] <p>where,</p> \[n_{s,weighted} = \sum_{\Delta \ell}^{n_{\Delta \ell}}(2(n_{layers}-\Delta \ell)/n_{\Delta \ell}),\] <p>and \(n_{\Delta \ell}\) is the number of subtypes for this type of interaction (e.g. \(n_{\Delta \ell}=2\) for our above example).</p> <p>Finally, we take the ensemble average of the overall average number of interactions for each frame:</p> \[\langle N(A_i \text{ } to \text{ } B_{j\neq i}) \rangle=\frac{1}{n_{f}}\sum_f^{n_f} N_{A_{i} \text{ } to \text{ } B_{j \neq i}}(f).\] <h4 id="intralayer-interactions">Intralayer Interactions</h4> <p>For intralayer interactions, such complexity is not needed. At each frame, the probability is computed by taking the number of interacting sites and dividing it by the number of total sites:</p> \[p_{A_i \text{ } to \text{ } B_i}(f) = \frac{n_{s,bound}}{n_{s}},\] <p>where \(n_s=2n_{layers}\) is the total number of sites. Similarly, the number of interactions per site is given by:</p> \[N_{A_i \text{ } to \text{ } B_i}(f) = \frac{2(n_{interactions})}{n_{s}}.\] <p>Then, \(P(A_i \text{ } to \text{ } B_i)\) and \(\langle N(A_i \text{ } to \text{ } B_i) \rangle\) are then computed in the same manner as for interlayer interactions.</p> <h3 id="residue-positions">Residue Positions</h3> <p>To determine the positions of the residues on the FibMap the positions of a central fibril layer are rotated such that the vector defined by its longest interatomic distance is aligned with the X-Axis. The purpose of this is twofold: (1) It will orient the layer so that it is closely aligned to the XY-plane, and (2) It will orient the positions so that the FibMap is wider than it is tall (i.e. landscape orientation). All layers of the fibril at all timesteps are then RMSD-fit to this layer using the Kabsch algorithm. The mean XY-position of each alpha-carbon, sidechain center-of-mass, or terminal atom center-of-mass is then taken for each position.</p> <p><em>NOTE: In the future, I may play around with various projections, but for now I figure that it’s best to keep it simple.</em></p> <p><em>NOTE: In the future, I will add an option for a portrait orientation.</em></p> <h3 id="trajectory-analysis">Trajectory Analysis</h3> <p>For the trajectory analysis (completed by the <code class="language-plaintext highlighter-rouge">FibMap.py traj</code> subcommand), the number of interactions of a given type per layer is computed for each frame. For a finite fibril model with \(n_{layers}\), an interlayer interaction with a layer separation of \(\Delta \ell\) can only occur \(n_{layers} - \Delta \ell\) times, so for a given frame the number of interactions per layer for a given type of interaction is computed as:</p> \[N(f) = \sum_{i} \frac{1}{n_{layers}-\Delta \ell(i)},\] <p>where \(\Delta \ell\) us the layer separation between the two sites (i.e. for interaction \(i\) between site \(A\) in layer \(\ell_A\) and site \(B\) in layer \(\ell_B\), \(\Delta \ell(i) = \|\ell_A - \ell_B \|\).</p> <h2 id="installation">Installation</h2> <p>Clone this repository:</p> <div class="repositories d-flex flex-wrap flex-md-row flex-column justify-content-between align-items-center"> <div class="repo p-2 text-center"> <a href="https://github.com/conor-b-abraham/FibMap" rel="external nofollow noopener" target="_blank"> <img class="repo-img-light w-100" alt="conor-b-abraham/FibMap" src="https://github-readme-stats.vercel.app/api/pin/?username=conor-b-abraham&amp;repo=FibMap&amp;theme=default&amp;show_owner=false"> <img class="repo-img-dark w-100" alt="conor-b-abraham/FibMap" src="https://github-readme-stats.vercel.app/api/pin/?username=conor-b-abraham&amp;repo=FibMap&amp;theme=dark&amp;show_owner=false"> </a> </div> </div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>git clone git@github.com:conor-b-abraham/FibMap.git
</code></pre></div></div> <p>And makes sure the dependencies below are installed.</p> <h3 id="dependencies">Dependencies</h3> <p>FibMap was developed for Python 3 using the following libraries:</p> <p><a href="https://www.mdanalysis.org" rel="external nofollow noopener" target="_blank"><img src="https://img.shields.io/badge/powered%20by-MDAnalysis-orange.svg?logoWidth=16&amp;logo=data:image/x-icon;base64,AAABAAEAEBAAAAEAIAAoBAAAFgAAACgAAAAQAAAAIAAAAAEAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJD+XwCY/fEAkf3uAJf97wGT/a+HfHaoiIWE7n9/f+6Hh4fvgICAjwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACT/yYAlP//AJ///wCg//8JjvOchXly1oaGhv+Ghob/j4+P/39/f3IAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJH8aQCY/8wAkv2kfY+elJ6al/yVlZX7iIiI8H9/f7h/f38UAAAAAAAAAAAAAAAAAAAAAAAAAAB/f38egYF/noqAebF8gYaagnx3oFpUUtZpaWr/WFhY8zo6OmT///8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgICAn46Ojv+Hh4b/jouJ/4iGhfcAAADnAAAA/wAAAP8AAADIAAAAAwCj/zIAnf2VAJD/PAAAAAAAAAAAAAAAAICAgNGHh4f/gICA/4SEhP+Xl5f/AwMD/wAAAP8AAAD/AAAA/wAAAB8Aov9/ALr//wCS/Z0AAAAAAAAAAAAAAACBgYGOjo6O/4mJif+Pj4//iYmJ/wAAAOAAAAD+AAAA/wAAAP8AAABhAP7+FgCi/38Axf4fAAAAAAAAAAAAAAAAiIiID4GBgYKCgoKogoB+fYSEgZhgYGDZXl5e/m9vb/9ISEjpEBAQxw8AAFQAAAAAAAAANQAAADcAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAjo6Mb5iYmP+cnJz/jY2N95CQkO4pKSn/AAAA7gAAAP0AAAD7AAAAhgAAAAEAAAAAAAAAAACL/gsAkv2uAJX/QQAAAAB9fX3egoKC/4CAgP+NjY3/c3Nz+wAAAP8AAAD/AAAA/wAAAPUAAAAcAAAAAAAAAAAAnP4NAJL9rgCR/0YAAAAAfX19w4ODg/98fHz/i4uL/4qKivwAAAD/AAAA/wAAAP8AAAD1AAAAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALGxsVyqqqr/mpqa/6mpqf9KSUn/AAAA5QAAAPkAAAD5AAAAhQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkUFBSuZ2dn/3V1df8uLi7bAAAATgBGfyQAAAA2AAAAMwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB0AAADoAAAA/wAAAP8AAAD/AAAAWgC3/2AAnv3eAJ/+dgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9AAAA/wAAAP8AAAD/AAAA/wAKDzEAnP3WAKn//wCS/OgAf/8MAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIQAAANwAAADtAAAA7QAAAMAAABUMAJn9gwCe/e0Aj/2LAP//AQAAAAAAAAAA" alt="MDAnalysis"></a></p> <p><a href="https://scipy.org/" rel="external nofollow noopener" target="_blank"><img src="https://img.shields.io/badge/SciPy-%230C55A5.svg?style=for-the-badge&amp;logo=scipy&amp;logoColor=%white" alt="Scipy"></a></p> <p><a href="https://numpy.org/" rel="external nofollow noopener" target="_blank"><img src="https://img.shields.io/badge/numpy-%23013243.svg?style=for-the-badge&amp;logo=numpy&amp;logoColor=white" alt="Numpy"></a></p> <p><a href="https://matplotlib.org/" rel="external nofollow noopener" target="_blank"><img src="https://img.shields.io/badge/Matplotlib-%23ffffff.svg?style=for-the-badge&amp;logo=Matplotlib&amp;logoColor=black" alt="MatPlotLib"></a></p> <h2 id="usage">Usage</h2> <p>The functionality of this program is broken up into three subcommands, <code class="language-plaintext highlighter-rouge">calc</code>, <code class="language-plaintext highlighter-rouge">map</code>, and <code class="language-plaintext highlighter-rouge">traj</code>. Use <code class="language-plaintext highlighter-rouge">calc</code> to compute interactions within the fibril structure. Then, use <code class="language-plaintext highlighter-rouge">map</code> to create the visualization and/or <code class="language-plaintext highlighter-rouge">traj</code> to perform the trajectory analysis.</p> <h3 id="calc">calc</h3> <p>The <code class="language-plaintext highlighter-rouge">calc</code> subcommand is used to compute the intermolecular forces within the fibril. This must be completed before running the <code class="language-plaintext highlighter-rouge">map</code> subcommand or the <code class="language-plaintext highlighter-rouge">traj</code> subcommand. Run this subcommand with <code class="language-plaintext highlighter-rouge">python FibMap.py calc ...</code>. For additional help with this subcommand run <code class="language-plaintext highlighter-rouge">python FibMap.py calc -h</code> or <code class="language-plaintext highlighter-rouge">python FibMap.py calc --help</code>.</p> <h4 id="parameters">Parameters</h4> <h5 id="input">Input</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-i/--input_file filename</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Input file containing parameters for calculation job. All commandline arguments can be specified in this file for user convenience. Any parameters given at the commandline will override their counterpart in this file. See <strong><a href="#additional-help">Additional Help:</a> Input File Help</strong> for more information.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-c/--checkpoint_file filename ...</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Checkpoint file(s) to resume from last saved checkpoint(s). These checkpoint file(s) includes the original parameters for the run. Any commandline arguments that will effect the results of the run (e.g. trajectory_file, topology_file, n_protofilaments, omit_layers, etc.) will be ignored if a checkpoint file is provided. Cannot be set if <code class="language-plaintext highlighter-rouge">-i/--input_file</code> is.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-f/--topology_file filename</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Topology file containing atom charges, bonds, and Segment IDs (e.g TPR). If no trajectory file is provided, the topology file must also contain coordinate information. The order of the segments is very important. See <a href="https://userguide.mdanalysis.org/stable/formats/index.html" rel="external nofollow noopener" target="_blank">MDAnalysis User Guide</a> for valid file formats. <em>IMPORTANT: A specific segment ordering is required. See</em> <strong><a href="#additional-help">Additional Help:</a> Topology File Setup</strong> <em>below for details.</em> </td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-f/--trajectory_file filename ...</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Trajectory file(s) containing coordinate information (e.g. XTC, TRR, PDB). If multiple are provided, the systems must match exactly. If none is provided, the coordinates will be collected from the topology file. See <a href="https://userguide.mdanalysis.org/stable/formats/index.html" rel="external nofollow noopener" target="_blank">MDAnalysis User Guide</a> for valid file formats.</td> </tr> </tbody> </table> <h5 id="output">Output</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-o/--output_directory path</code></td> <td style="text-align: center">Working Dir.</td> <td style="text-align: right">Directory to write files to. This directory must already exist.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-v/--verbose</code></td> <td style="text-align: center">True</td> <td style="text-align: right">Pass calculated interactions to standard output.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]saveraw</code></td> <td style="text-align: center">saveraw</td> <td style="text-align: right">If saveraw, the unprocessed results will be saved. NOTE: The trajectory analysis subcommand requires these results.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]log</code></td> <td style="text-align: center">nolog</td> <td style="text-align: right">If log, save standard output to a log file. This option is better than manually passing stdout to a file at the commandline, as it will not write progress bars to the file.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]backup</code></td> <td style="text-align: center">backup</td> <td style="text-align: right">If backup, past logfiles and checkpoint files will be backed up.</td> </tr> </tbody> </table> <h5 id="options">Options</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--calctype {ALL, HB, SB, PI, HB+SB, HB+PI, SB+PI}</code></td> <td style="text-align: center">ALL</td> <td style="text-align: right">What type of interaction to compute. Options are ALL, HB, SB, PI, HB+SB, HB+PI, and SB+PI. ALL computes all, options with HB computes hydrogen bonds, options with SB computes salt bridges, and options with PI computes pi stacking interactions.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">-n/--n_protofilaments int</code> (int \(\gt\) -2)</td> <td style="text-align: center">Required</td> <td style="text-align: right">The number of protofilaments in the fibril (i.e. how many segments are in each layer of the fibril).</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--omit_layers int</code> (int \(\geq\) 0)</td> <td style="text-align: center">0</td> <td style="text-align: right">How many layers on each end of the fibril to omit from analysis. This is especially important for analysis of simulation trajectories of a finite fibril model as delamination at the ends of the fibril will bias the results.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--hbond_distance_cutoff float</code> (float \(\gt\) 0)</td> <td style="text-align: center">3.5Å</td> <td style="text-align: right">The cutoff distance (in Å) for hydrogen bonds. The distance between a potential donor and potential acceptor must be less than this value to be counted as a hydrogen bond.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--hbond_angle_cutoff float</code> (float \(\gt\) 0)</td> <td style="text-align: center">150°</td> <td style="text-align: right">The cutoff angle (in degrees) for hydrogen bonds. The angle from a potential donor to a potential hydrogen to a potential acceptor must be greater than this value to be counted as a hydrogen bond.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--saltbridge_selection_mode {auto, manual}</code></td> <td style="text-align: center">auto</td> <td style="text-align: right">The salt bridge participant selection mode. If auto, <code class="language-plaintext highlighter-rouge">--saltbridge_anion_charge_cutoff</code> and <code class="language-plaintext highlighter-rouge">--saltbridge_cation_charge_cutoff</code> will be used to identify potential salt bridge participants. If manual, <code class="language-plaintext highlighter-rouge">--saltbridge_anion_sel</code> and <code class="language-plaintext highlighter-rouge">--saltbridge_cation_sel</code> will be used to find the participants.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--saltbridge_anion_charge_cutoff float</code></td> <td style="text-align: center">-0.5e</td> <td style="text-align: right">Used if <code class="language-plaintext highlighter-rouge">--saltbridge_selection_mode auto</code>. Charge cutoff (in e) for salt bridge participant selection. If an atom group belonging to a anionic residue has a charge less than this value, it will be considered a salt bridge participant.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--saltbridge_cation_charge_cutoff float</code></td> <td style="text-align: center">-0.5e</td> <td style="text-align: right">Used if <code class="language-plaintext highlighter-rouge">--saltbridge_selection_mode auto</code>. Charge cutoff (in e) for salt bridge participant selection. If an atom group belonging to a cationic residue has a charge greater than this value, it will be considered a salt bridge participant.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--saltbridge_anion_sel MDAnalysis_Selection_String</code></td> <td style="text-align: center">((resname ASP and name OD1 OD2) or (resname GLU and name OE1 OE2))</td> <td style="text-align: right">Used if <code class="language-plaintext highlighter-rouge">--saltbridge_selection_mode manual</code>. Selection command for anionic salt bridge participants. For help formatting this string, see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--saltbridge_cation_sel MDAnalysis_Selection_String</code></td> <td style="text-align: center">((resname LYS and name NZ) or (resname ARG and name NH1 NH2 NE) or (resname HSP and name ND1 NE2))</td> <td style="text-align: right">Used if <code class="language-plaintext highlighter-rouge">--saltbridge_selection_mode manual</code>. Selection command for cationic salt bridge participants. For help formatting this string, see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--saltbridge_distance_cutoff float</code> (float \(\gt\) 0)</td> <td style="text-align: center">4.0Å</td> <td style="text-align: right">The cutoff distance (in Å) for salt bridges. The minimum distance between anionic and cationic groups must be less than or equal to this value to be counted as a salt bridge.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--pistacking_phe_sel MDAnalysis_Selection_String</code></td> <td style="text-align: center">(resname PHE and name CG CD2 CE2 CZ CE1 CD1)</td> <td style="text-align: right">The MDAnalysis selection command for phenylalanine rings. For help formatting this string, see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--pistacking_tyr_sel MDAnalysis_Selection_String</code></td> <td style="text-align: center">(resname TYR and name CG CD2 CE2 CZ CE1 CD1)</td> <td style="text-align: right">The MDAnalysis selection command for tyrosine rings. For help formatting this string, see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--pistacking_his_sel MDAnalysis_Selection_String</code></td> <td style="text-align: center">(resname HSD HSE HSP and name CG CD2 NE2 CE1 ND1)</td> <td style="text-align: right">The MDAnalysis selection command for histidine rings. For help formatting this string, see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--pistacking_trp_sel MDAnalysis_Selection_String</code></td> <td style="text-align: center">(resname TRP and name CG CD1 NE1 CE2 CD2)</td> <td style="text-align: right">The MDAnalysis selection command for tryptophan rings (should be for the 5-membered ring). For help formatting this string, see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/selections.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--nprocs int</code> (int \(\geq\)-2)</td> <td style="text-align: center">1</td> <td style="text-align: right">How many processors to use for hydrogen bond and pi stacking calculations. Use -1 to use all available processors, -2 to use half of the available processors, or some positive integer.</td> </tr> </tbody> </table> <h4 id="additional-help">Additional Help</h4> <h5 id="topology-file-setup">Topology File Setup</h5> <p>FibMap.py does not determine the relative location of each segment automatically, and therefore, the order of the segments must be predictable (proper ordering described below). If you did not originally set up your system in the described order you can try to reorder it using MDAnalysis.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/topology_order-480.webp 480w,/assets/img/fibmap/topology_order-800.webp 800w,/assets/img/fibmap/topology_order-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/topology_order.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Topology file segid order" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 7: An example fibril showing the proper order of segments in the topology. The fibril shown is an extended version of the human Serum Amyloid A (hSAA) fibril resolved by Cryo-EM ([PDB 6MST](https://www.rcsb.org/structure/6MST)) by Liberta et al. [12]. </div> <p>The proper order should be layer by layer and protofilament by protofilament. For example, consider the fibril shown in Figure 7 with 12 layers and 2 protofilaments. Each segment is named with P[Protofilament #][Layer #] (e.g. the segment in layer 1 and protofilament 1 is P11, the segment in layer 1 and protofilament 2 is P21), the segment in layer 2 and protofilament 1 is P12, etc.).</p> <p>The order of the segments in the topology file should be:</p> <ol> <li>Layer 1, Protofilament 1 (P11)</li> <li>Layer 1, Protofilament 2 (P21)</li> <li>Layer 2, Protofilament 1 (P12)</li> <li>Layer 2, Protofilament 2 (P22)</li> <li>Layer 3, Protofilament 1 (P13)</li> <li>Layer 3, Protofilament 2 (P23)</li> <li>Layer 4, Protofilament 1 (P11)</li> <li>Layer 4, Protofilament 2 (P21)</li> <li>Layer 5, Protofilament 1 (P12)</li> <li>Layer 5, Protofilament 2 (P22)</li> <li>Layer 6, Protofilament 1 (P13)</li> <li>Layer 6, Protofilament 2 (P23)</li> <li>Layer 7, Protofilament 1 (P11)</li> <li>Layer 7, Protofilament 2 (P21)</li> <li>Layer 8, Protofilament 1 (P12)</li> <li>Layer 8, Protofilament 2 (P22)</li> <li>Layer 9, Protofilament 1 (P13)</li> <li>Layer 9, Protofilament 2 (P23)</li> <li>Layer 10, Protofilament 1 (P11)</li> <li>Layer 10, Protofilament 2 (P21)</li> <li>Layer 11, Protofilament 1 (P12)</li> <li>Layer 11, Protofilament 2 (P22)</li> <li>Layer 12, Protofilament 1 (P13)</li> <li>Layer 12, Protofilament 2 (P23)</li> </ol> <h5 id="input-file-help">Input File Help</h5> <p>The parameters can be provided in an input file (specified with <code class="language-plaintext highlighter-rouge">-i/--input_file</code>) for the user’s convenience. Only one parameter is allowed per line, separate the parameters name and the chosen value(s) with an equal-to sign (=). For flags (i.e. verbose, [no]saveraw, [no]log, [no]backup), set the value to either ‘True’ or ‘False’. Lines may be commented out with a pound/hash/number sign (#). If a parameter can take multiple values (e.g. trajectory_file), you can either use separate entries for each value (e.g. put <code class="language-plaintext highlighter-rouge">trajectory_file = filename1</code>, <code class="language-plaintext highlighter-rouge">trajectory_file = filename2</code>, etc. on separate lines) or you can separate the filenames with a space in a single entry (e.g. <code class="language-plaintext highlighter-rouge">trajectory_file = filename1 filename2 ...</code>).</p> <p><strong>Input File Template</strong></p> <p>Here is a input file template for the <code class="language-plaintext highlighter-rouge">calc</code> subcommand to get you started:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># `Fibmap.py calc` input file template. Pass to -i/--input_file at commandline.
</span>
<span class="c1"># Input Files
</span><span class="n">topology_file</span>                   <span class="o">=</span> <span class="c1"># The name of the topology file
</span><span class="n">trajectory_file</span>                 <span class="o">=</span> <span class="c1"># The name(s) for the trajectory file(s)
</span><span class="n">checkpoint_file</span>                 <span class="o">=</span> <span class="c1"># The name(s) of the checkpoint file(s) (Only after you've run calc at least once)
</span>
<span class="c1"># Output
</span><span class="n">output_directory</span>                <span class="o">=</span> <span class="c1"># The path to your output directory
</span><span class="n">verbose</span>                         <span class="o">=</span> <span class="c1"># [True/False] verbosity
</span><span class="n">backup</span>                          <span class="o">=</span> <span class="c1"># [True/False] make backups
</span><span class="n">saveraw</span>                         <span class="o">=</span> <span class="c1"># [True/False] save unprocessed interactions
</span><span class="n">log</span>                             <span class="o">=</span> <span class="c1"># [True/False] write a logfile
</span>
<span class="c1"># Options
</span><span class="n">calctype</span>                        <span class="o">=</span> <span class="c1"># The calculation type (ALL, HB, SB, PI, HB+SB, HB+PI, or SB+PI)
</span><span class="n">n_protofilaments</span>                <span class="o">=</span> <span class="c1"># The number of protofilaments in your fibril
</span><span class="n">omit_layers</span>                     <span class="o">=</span> <span class="c1"># The number of layers to omit from each end of the fibril
</span><span class="n">hbond_distance_cutoff</span>           <span class="o">=</span> <span class="c1"># The D-A distance cutoff for hydrogen bonds
</span><span class="n">hbond_angle_cutoff</span>              <span class="o">=</span> <span class="c1"># The D-H-A angle cutoff for hyrogen bonds
</span><span class="n">saltbridge_selection_mode</span>       <span class="o">=</span> <span class="c1"># The salt bridge participant selection mode (auto or manual)
</span><span class="n">saltbridge_anion_charge_cutoff</span>  <span class="o">=</span> <span class="c1"># The charge cutoff for anions with auto selection mode
</span><span class="n">saltbridge_cation_charge_cutoff</span> <span class="o">=</span> <span class="c1"># The charge cutoff for cations with auto selection mode
</span><span class="n">saltbridge_anion_sel</span>            <span class="o">=</span> <span class="c1"># The selection command for anions with manual selection mode
</span><span class="n">saltbridge_cation_sel</span>           <span class="o">=</span> <span class="c1"># The selection command for cations with manual selection mode
</span><span class="n">saltbridge_distance_cutoff</span>      <span class="o">=</span> <span class="c1"># The maximum minimum distance between charged groups for it to be counted as saltbridge
</span><span class="n">pistacking_phe_sel</span>              <span class="o">=</span> <span class="c1"># The selection command for phenylalanine rings
</span><span class="n">pistacking_tyr_sel</span>              <span class="o">=</span> <span class="c1"># The selection command for tyrosine rings
</span><span class="n">pistacking_his_sel</span>              <span class="o">=</span> <span class="c1"># The selection command for histidine rings
</span><span class="n">pistacking_trp_sel</span>              <span class="o">=</span> <span class="c1"># The selection command for tryptophan rings
</span><span class="n">nprocs</span>                          <span class="o">=</span> <span class="c1"># The number of processors to use
</span></code></pre></div></div> <h5 id="a-tip-to-speed-up-the-calculation">A Tip to Speed Up the Calculation</h5> <p>Depending on the length of your trajectory and the size of your system the calculation of hydrogen bonds, salt bridges, and pi stacking interactions can take a long time. To speed this up, you can compute each interaction type separately. Also, note that the calculation of hydrogen bonds and salt bridges can be parallelized, but the calculation of pi stacking interactions can only be completed on a single processor (because the pi stacking calculation is relatively fast). These separate calculations can be run using <code class="language-plaintext highlighter-rouge">--calctype</code> and <code class="language-plaintext highlighter-rouge">--nprocs</code>.</p> <h3 id="map">map</h3> <p>After the intermolecular forces have been computed with the <code class="language-plaintext highlighter-rouge">calc</code> subcommand, the <code class="language-plaintext highlighter-rouge">map</code> subcommand can be used to create the fibril map. Run this subcommand with <code class="language-plaintext highlighter-rouge">python FibMap.py map ...</code>. For additional help with this subcommand run <code class="language-plaintext highlighter-rouge">python FibMap.py map -h</code> or <code class="language-plaintext highlighter-rouge">python FibMap.py map --help</code>.</p> <p><em>NOTE: This subcommand can only be run after the <code class="language-plaintext highlighter-rouge">calc</code> subcommand has completed.</em></p> <h4 id="parameters-1">Parameters</h4> <h5 id="input-1">Input</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-c/--checkpoint_file filename ...</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Checkpoint file(s) from finished calc job or previous map job.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-i/--input_file filename</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Input file containing parameters for mapping job. All required commandline arguments and additional formatting parameters can alternatively be specified in this file. Arguments given at the commandline will override any of their counterparts given in this file. See <strong><a href="#additional-help-1">Additional Help:</a> Input File Help &amp; Additional Parameters</strong> below for a list of parameters that can be set in this file.</td> </tr> </tbody> </table> <h5 id="output-1">Output</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-o/--figure_file filename</code></td> <td style="text-align: center">[output_directory]/fibmap.png</td> <td style="text-align: right">Path to and name of output image file. Can be any filetype that can be written by matplotlib. If using default, [output_directory] is the output directory specified for the previous calc run.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]log</code></td> <td style="text-align: center">nolog</td> <td style="text-align: right">If log, save standard output to a log file. This option is better than manually passing stdout to a file at the commandline, as it will not write progress bars to the file.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]backup</code></td> <td style="text-align: center">backup</td> <td style="text-align: right">If backup, past logfiles and past figure file images will be backed up.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--showfig</code></td> <td style="text-align: center">False</td> <td style="text-align: right">If used, the figure image will be opened after it is saved.</td> </tr> </tbody> </table> <h5 id="options-1">Options</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--p_cutoff float</code> (0 \(\leq\) float \(\leq\) 1)</td> <td style="text-align: center">0.5</td> <td style="text-align: right">Probability cutoff for hydrogen bonds, salt bridges, and pi stacking interactions. If the probability of a given interaction is less than this value then it will not be displayed on the map. (TIP: To hide all interactions, set this value to 1 and do not set <code class="language-plaintext highlighter-rouge">--hbond_n_cutoff</code>, <code class="language-plaintext highlighter-rouge">--hbond_p_cutoff</code>, <code class="language-plaintext highlighter-rouge">--saltbridge_p_cutoff</code>, or <code class="language-plaintext highlighter-rouge">--pistacking_p_cutoff</code>).</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--hbond_p_cutoff float</code> (0 \(\leq\) float \(\leq\) 1)</td> <td style="text-align: center">None</td> <td style="text-align: right">Individually set the probability cutoff for hydrogen bonds. If not set, p_cutoff will be used. (TIP: To hide all hydrogen bonds, set this value to 1 and do not set <code class="language-plaintext highlighter-rouge">--hbond_n_cutoff</code>).</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--hbond_n_cutoff float</code> (float \(\geq\) 0)</td> <td style="text-align: center">None</td> <td style="text-align: right">If set, the average number of hydrogen bonds per frame formed between two groups will be used to determine whether or not a hydrogen bond is shown on the figure instead of a probability cutoff. If the average number of hydrogen bonds per frame is less than this cutoff then the hydrogen bond will not be displayed on the map.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--saltbridge_p_cutoff float</code> (0 \(\leq\) float \(\leq\) 1)</td> <td style="text-align: center">None</td> <td style="text-align: right">Individually set the probability cutoff for salt bridges. If not set, p_cutoff will be used. (TIP: To hide all salt bridges, set this value to 1).</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--pistacking_p_cutoff float</code> (0 \(\leq\) float \(\leq\) 1)</td> <td style="text-align: center">None</td> <td style="text-align: right">Individually set the probability cutoff for pi stacking interactions. If not set, p_cutoff will be used. (TIP: To hide all pi stacking interactions, set this value to 1).</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]legend</code></td> <td style="text-align: center">legend</td> <td style="text-align: right">If legend, a legend will be included in the figure.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--nprocs int</code> (int \(\geq\) -2)</td> <td style="text-align: center">1</td> <td style="text-align: right">How many processors to use for the position calculation. Use -1 to use all available processors, -2 to use half of the available processors, or some positive integer.</td> </tr> </tbody> </table> <h4 id="additional-help-1">Additional Help</h4> <h5 id="input-file-help--additional-parameters">Input File Help &amp; Additional Parameters</h5> <p>The above parameters (and the additional parameters below) can be provided in an input file (specified with <code class="language-plaintext highlighter-rouge">-i/--input_file</code>) for the user’s convenience. Only one parameter is allowed per line, separate the parameters name and the chosen value(s) with an equal-to sign (=). For flags (i.e. verbose, [no]log, [no]backup), set the value to either ‘True’ or ‘False’. Lines may be commented out with a pound/hash/number sign (#). If a parameter can take multiple values (e.g. trajectory_file), you can either use separate entries for each value (e.g. put <code class="language-plaintext highlighter-rouge">checkpoint_file = filename1</code>, <code class="language-plaintext highlighter-rouge">checkpoint_file = filename2</code>, etc. on separate lines) or you can separate the filenames with a space in a single entry (e.g. <code class="language-plaintext highlighter-rouge">checkpoint_file = filename1 filename2 ...</code>). The following additional parameters can also be defined in the input file:</p> <p><strong>Hydrophobic Zippers and Water Channels</strong></p> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">water_region = WaterRegion</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Define the location of a water channel. See <strong><a href="#additional-help-1">Additional Help:</a> Specifying Shaded Regions</strong> below for details. Multiple can be defined with separate entries.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">zipper_region = ZipperRegion</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Define the location of a hydrophobic zipper. See <strong><a href="#additional-help-1">Additional Help:</a> Specifying Shaded Regions</strong> below for details. Multiple can be defined with separate entries.</td> </tr> </tbody> </table> <p><em>Figure Settings</em></p> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">figure_width = float</code> (float \(\gt\) 0)</td> <td style="text-align: center">6.5</td> <td style="text-align: right">Figure width in inches.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">figure_height = float</code> (float \(\gt\) 0)</td> <td style="text-align: center">4.5</td> <td style="text-align: right">Figure height in inches.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">figure_dpi = int</code></td> <td style="text-align: center">300</td> <td style="text-align: right">The figure resolution in dots per inch (dpi).</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">transparent_background = True/False</code></td> <td style="text-align: center">False</td> <td style="text-align: right">Make the figure transparent</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">numbered_residues = True/False</code></td> <td style="text-align: center">False</td> <td style="text-align: right">By default, the residues will be labelled with their 1-letter residue name abbreviation. If you use this option, they will instead be labelled with their one-based residue index. This is useful for determining shaded regions.</td> </tr> </tbody> </table> <p><strong>Colors</strong></p> <p><em>NOTE: All colors must be valid matplotlib colors. See matplotlib <a href="https://matplotlib.org/stable/tutorials/colors/colors.html" rel="external nofollow noopener" target="_blank">documentation</a> for options. Some residue-specific colors (if indicated) can also be set to the color of the residues’ chains with option “chain”.</em></p> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">acidic_color = color</code></td> <td style="text-align: center">steelblue</td> <td style="text-align: right">Color of acidic residues.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">acidic_label_color = color or "chain"</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Color of acidic residue labels. If “chain” residue labels will be given the same color as their chain backbone color.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">basic_color = color</code></td> <td style="text-align: center">firebrick</td> <td style="text-align: right">Color of acidic residues.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">basic_label_color = color or "chain"</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Color of basic residue labels. If “chain” residue labels will be given the same color as their chain backbone color.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">polar_color = color</code></td> <td style="text-align: center">seagreen</td> <td style="text-align: right">Color of polar residues.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">polar_label_color = color or "chain"</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Color of polar residue labels. If “chain” residue labels will be given the same color as their chain backbone color.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">nonpolar_color = color</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Color of nonpolar residues.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">nonpolar_label_color = color or "chain"</code></td> <td style="text-align: center">chain</td> <td style="text-align: right">Color of nonpolar residue labels. If “chain” residue labels will be given the same color as their chain backbone color.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">backbone_colors = color ...</code></td> <td style="text-align: center">black dimgray</td> <td style="text-align: right">Color(s) of chain backbone(s). If more than one is given, the specified colors will be cycled through. If a color is given as a tuple or a list it should not have any spaces in it (e.g. (0,0,0) not (0, 0, 0)). Separate each color with a whitespace (i.e. spaces or tabs).</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">hbond_color_1 = color</code></td> <td style="text-align: center">black</td> <td style="text-align: right">Color of hydrogen bonds.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">hbond_color_2 = color</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Color of dashed line for hydrogen bonds that are both intra- and inter-layer.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">saltbridge_color_1 = color</code></td> <td style="text-align: center">gold</td> <td style="text-align: right">Fill color for salt bridges.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">saltbridge_color_2 = color</code></td> <td style="text-align: center">orange</td> <td style="text-align: right">Outline color for salt bridges.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">saltbridge_color_3 = color</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Color of dashed line for salt bridges that are both intra- and inter-layer.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">pistacking_color_1 = color</code></td> <td style="text-align: center">gray</td> <td style="text-align: right">Line color for pi stacking interaction lines and edge color for pi stacking interaction markers.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">pistacking_color_2 = color</code></td> <td style="text-align: center">white</td> <td style="text-align: right">Fill color for pi stacking interaction markers and dashed line color for pi stacking interactions that are both intra-and inter-layer.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">water_color = color</code></td> <td style="text-align: center">powderblue</td> <td style="text-align: right">Color of water regions.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">water_opacity = float</code> (0 \(\leq\) float \(\leq\) 1)</td> <td style="text-align: center">0.5</td> <td style="text-align: right">Opacity of water regions.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">zipper_color = color</code></td> <td style="text-align: center">tan</td> <td style="text-align: right">Color of hydrophobic zipper regions.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">zipper_opacity = float</code> (0 \(\leq\) float \(\leq\) 1)</td> <td style="text-align: center">0.5</td> <td style="text-align: right">Opacity of hydrophobic zipper regions.</td> </tr> </tbody> </table> <p><em>NOTE: See Figure 8 below for color guide.</em></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/ColorGuide-480.webp 480w,/assets/img/fibmap/ColorGuide-800.webp 800w,/assets/img/fibmap/ColorGuide-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/ColorGuide.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Color Guide" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 8: Guide to adjustable colors. </div> <p><strong>Input File Template</strong></p> <p>Heres an input file template for the <code class="language-plaintext highlighter-rouge">map</code> subcommand to get you started:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># `Fibmap.py map` input file template. Pass to -i/--input_file at commandline.
</span>
<span class="c1"># Input
</span><span class="n">checkpoint_file</span>        <span class="o">=</span> <span class="c1"># the name of the checkpoint file from a previous calc or map run.
</span>
<span class="c1"># Output
</span><span class="n">figure_file</span>            <span class="o">=</span> <span class="c1"># the name of the image file to save
</span><span class="n">verbose</span>                <span class="o">=</span> <span class="c1"># [True/False] verbosity
</span><span class="n">backup</span>                 <span class="o">=</span> <span class="c1"># [True/False] make backups
</span><span class="n">log</span>                    <span class="o">=</span> <span class="c1"># [True/False] write a logfile
</span><span class="n">showfig</span>                <span class="o">=</span> <span class="c1"># [True/False] open the figure after saving
</span>
<span class="c1"># Options
</span><span class="n">p_cutoff</span>               <span class="o">=</span> <span class="c1"># Probability cutoff for all interactions
</span><span class="n">hbond_p_cutoff</span>         <span class="o">=</span> <span class="c1"># Probability cutoff for hydrogen bonds (cannot be set if hbond_n_cutoff is)
</span><span class="n">hbond_n_cutoff</span>         <span class="o">=</span> <span class="c1"># Count cutoff for hydrogen bonds (cannot be set if hbond_p_cutoff is)
</span><span class="n">saltbridge_p_cutoff</span>    <span class="o">=</span> <span class="c1"># Probability cutoff for salt bridges
</span><span class="n">pistacking_p_cutoff</span>    <span class="o">=</span> <span class="c1"># Probability cutoff for pi stacking interactions
</span><span class="n">legend</span>                 <span class="o">=</span> <span class="c1"># [True/False] Whether to include a legend
</span><span class="n">nprocs</span>                 <span class="o">=</span> <span class="c1"># The number of processors to use
</span>
<span class="c1"># Additional Parameters
# Hydrophobic Zippers and Water Channels
</span><span class="n">water_region</span>           <span class="o">=</span> <span class="c1"># Water Channel Definition(s)
</span><span class="n">zipper_region</span>          <span class="o">=</span> <span class="c1"># Hydrophobic Zipper Definition(s)
</span>
<span class="c1"># Figure Settings
</span><span class="n">figure_width</span>           <span class="o">=</span> <span class="c1"># Width of Figure in inches
</span><span class="n">figure_height</span>          <span class="o">=</span> <span class="c1"># Height of Figure in inches
</span><span class="n">figure_dpi</span>             <span class="o">=</span> <span class="c1"># Figure resolution in dots per inch (dpi)
</span><span class="n">transparent_background</span> <span class="o">=</span> <span class="c1"># [True/False] Make background transparent
</span><span class="n">numbered_residues</span>      <span class="o">=</span> <span class="c1"># [True/False] Number the residues instead of labelling with 1-letter name abbreviations
</span>
<span class="c1"># Colors
</span><span class="n">acidic_color</span>           <span class="o">=</span> <span class="c1"># Color of acidic residues
</span><span class="n">acidic_label_color</span>     <span class="o">=</span> <span class="c1"># Color of acidic residue labels
</span><span class="n">basic_color</span>            <span class="o">=</span> <span class="c1"># Color of basic residues 
</span><span class="n">basic_label_color</span>      <span class="o">=</span> <span class="c1"># Color of basic residue labels
</span><span class="n">polar_color</span>            <span class="o">=</span> <span class="c1"># Color of polar residues
</span><span class="n">polar_label_color</span>      <span class="o">=</span> <span class="c1"># Color of polar residue labels
</span><span class="n">nonpolar_color</span>         <span class="o">=</span> <span class="c1"># Color of nonpolar residues
</span><span class="n">nonpolar_label_color</span>   <span class="o">=</span> <span class="c1"># Color of nonpolar residue labels
</span><span class="n">backbone_colors</span>        <span class="o">=</span> <span class="c1"># Color(s) of chain backbones
</span><span class="n">hbond_color_1</span>          <span class="o">=</span> <span class="c1"># Color of hydrogen bonds
</span><span class="n">hbond_color_2</span>          <span class="o">=</span> <span class="c1"># Color of dashed line for hydrogen bonds that are intra- and inter-layer
</span><span class="n">saltbridge_color_1</span>     <span class="o">=</span> <span class="c1"># Fill color for salt bridges
</span><span class="n">saltbridge_color_2</span>     <span class="o">=</span> <span class="c1"># Outline color for salt bridges
</span><span class="n">saltbridge_color_3</span>     <span class="o">=</span> <span class="c1"># Color of dashed line for salt bridges that are intra- and inter-layer
</span><span class="n">pistacking_color_1</span>     <span class="o">=</span> <span class="c1"># Line color for pi stacking interactions
</span><span class="n">pistacking_color_2</span>     <span class="o">=</span> <span class="c1"># Fill for pi stacking interactions
</span><span class="n">water_color</span>            <span class="o">=</span> <span class="c1"># Color of water channel regions
</span><span class="n">water_opacity</span>          <span class="o">=</span> <span class="c1"># Opacity of water channel regions
</span><span class="n">zipper_color</span>           <span class="o">=</span> <span class="c1"># Color of hydrophobic zipper regions
</span><span class="n">zipper_opacity</span>         <span class="o">=</span> <span class="c1"># Opacity of hydrophobic zipper regions
</span></code></pre></div></div> <h5 id="specifying-shaded-regions">Specifying Shaded Regions</h5> <p>On the map, hydrophobic zippers and water channels can be highlighted. These regions can be specified in the input file with the <code class="language-plaintext highlighter-rouge">zipper_region</code> and <code class="language-plaintext highlighter-rouge">water_region</code> options. Individual shaded regions are identified by following a path along the residues that define their borders.</p> <p>To define the path: Enter a series of sides separated by commas (,). Each side must contain a protofilament number (one-based) and a pair of residue numbers (using the resids from your topology). The protofilament number should be separated from the residue numbers by a colon (:) and the residue numbers should be separated from one another by a hyphen (-):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[Protofilament Number]:[Residue 1 Number]-[Residue 2 Number]
</code></pre></div></div> <p>From the path, a polygon will be defined to go from residue to residue within each side and from the last residue of a side to the first residue of the next side. As such, the first residue in each side should be the one closest to the last residue in the previous side.</p> <blockquote> <p>IMPORTANT: There cannot be any white space (e.g. spaces, tabs, etc.) in the path specification string.</p> <p>TIP 1: Only one side is necessary so you can specify a region encapsulated by a U-bend.</p> <p>TIP 2: If you want a region to contact a part of the side only at one residue you can list that residue twice in a side (e.g. 1:4,4)</p> </blockquote> <p><strong>Example A</strong></p> <p>A hydrophobic zipper between residues 1 to 32 on protofilament 1 and residues 1 to 32 on protofilament 2.</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/zipperregionfibmap-480.webp 480w,/assets/img/fibmap/zipperregionfibmap-800.webp 800w,/assets/img/fibmap/zipperregionfibmap-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/zipperregionfibmap.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Zipper Region" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 9: Example of a FibMap showing a hydrophobic zipper. This image was generated using FibMap and [PDB 6MST](https://www.rcsb.org/structure/6MST) [[12]](#references). </div> <p>To add this region to the visualization add the following line to your input file:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>zipper_region = 1:1-32,2:32-1
</code></pre></div></div> <p><strong>Example B</strong></p> <p>Two water channels encompassed by residues 22-50 of protofilament 1 and 22-50 of protofilament 2 .</p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/waterregionfibmap-480.webp 480w,/assets/img/fibmap/waterregionfibmap-800.webp 800w,/assets/img/fibmap/waterregionfibmap-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/waterregionfibmap.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Water Channel" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 10: Example of a FibMap showing two water channels. *NOTE: This image was generated using FibMap and [PDB 6MST](https://www.rcsb.org/structure/6MST) [[12]](#references)* </div> <p>To add these region to the visualization you can define them within your map input file by adding the following lines:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>water_region = 1:22-50
water_region = 2:22-50
</code></pre></div></div> <p>OR you can define them on the same line:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>water_region = 1:22-50 2:22-50
</code></pre></div></div> <h5 id="bypassing-the-checkpoint-system">Bypassing the checkpoint system</h5> <p>I implemented the checkpoint system to ensure that users do not use a different system for the <code class="language-plaintext highlighter-rouge">calc</code> step and the <code class="language-plaintext highlighter-rouge">map</code> step. It also makes it so that the system does not need to be redescribed when running the <code class="language-plaintext highlighter-rouge">map</code> step. Let’s say, however, that you don’t care about the intermolecular forces and you just want to make a nice graphic of a layer of your fibril. In that case, you can just create a dummy checkpoint file (it’s just a text file with several key parameters defined). Here’s a template:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>trajectory_file = # The name of the trajectory file
topology_file = # The name of the topology file
output_directory = # The output directory path
n_protofilaments = # The number of protofilaments
omit_layers = # The number of layers to omit on each end of the fibril
</code></pre></div></div> <p><em>NOTE: All of these parameters are described in <a href="#parameters">calc: Parameters</a></em></p> <p>Alternatively, you could perform the calculation step on a single frame PDB of your fibril (will only take a second), and then run <code class="language-plaintext highlighter-rouge">map</code> with <code class="language-plaintext highlighter-rouge">--p_cutoff 1.0</code>.</p> <h3 id="traj">traj</h3> <p><strong>This module is currently in development, so proceed with caution.</strong></p> <p>Use this subcommand to analyze the trajectory from the calc subcommand (with –saveraw) and plot the number of each type of interaction per layer versus time. For additional help use: <code class="language-plaintext highlighter-rouge">FibMap.py traj -h</code> or <code class="language-plaintext highlighter-rouge">FibMap.py traj --help</code>.</p> <p><em>NOTE: This subcommand can only be run after the <code class="language-plaintext highlighter-rouge">calc</code> subcommand with –saveraw has been completed.</em></p> <h4 id="parameters-2">Parameters</h4> <h5 id="input-2">Input</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-c/--checkpoint_file filename ...</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Checkpoint file(s) to finished calc job or previous traj job.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-i/--input_file filename</code></td> <td style="text-align: center">None</td> <td style="text-align: right">Input file containing parameters for trajectory analysis job. All required commandline arguments and additional formatting parameters can alternatively be specified in this file. Arguments given at the commandline will override any of their counterparts given in this file. See <strong><a href="#additional-help-2">Additional Help:</a> Input File Help</strong> below for additional help.</td> </tr> </tbody> </table> <h5 id="output-2">Output</h5> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">-o/--figure_file filename</code></td> <td style="text-align: center">[output_directory]/fibmap.png</td> <td style="text-align: right">Path to and name of output image file. Can be any filetype that can be written by matplotlib. If using default, [output_directory] is the output directory specified for the previous calc/map run.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]log</code></td> <td style="text-align: center">nolog</td> <td style="text-align: right">If log, save standard output to a log file. This option is better than manually passing stdout to a file at the commandline, as it will not write progress bars to the file.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--[no]backup</code></td> <td style="text-align: center">backup</td> <td style="text-align: right">If backup, past logfiles and past figure file images will be backed up.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--showfig</code></td> <td style="text-align: center">False</td> <td style="text-align: right">If used, the figure image will be opened after it is saved.</td> </tr> </tbody> </table> <h5 id="options-2">Options</h5> <p><em>NOTE: All colors must be valid matplotlib colors. See matplotlib <a href="https://matplotlib.org/stable/tutorials/colors/colors.html" rel="external nofollow noopener" target="_blank">documentation</a> for options.</em></p> <table> <thead> <tr> <th style="text-align: left">Argument</th> <th style="text-align: center">Default</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--figure_width int</code> (int \(\gt\) 0)</td> <td style="text-align: center">3.5in</td> <td style="text-align: right">Set the figure width in inches.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--figure_height int</code> (int \(\gt\) 0)</td> <td style="text-align: center">4in</td> <td style="text-align: right">Set the figure height in inches.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--figure_dpi int</code> (int \(\gt\) 0)</td> <td style="text-align: center">300dpi</td> <td style="text-align: right">Set the figure resolution in dots per inch.</td> </tr> <tr> <td style="text-align: left"> <code class="language-plaintext highlighter-rouge">--fontsize float</code> (float \(\gt\) 0)</td> <td style="text-align: center">6pt</td> <td style="text-align: right">Set the fontsize used on the plot. The font is Arial.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--total_color color</code></td> <td style="text-align: center">black</td> <td style="text-align: right">Color of the total lines.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--intralayer_color</code></td> <td style="text-align: center">black</td> <td style="text-align: right">Color of the intralayer lines.</td> </tr> <tr> <td style="text-align: left"><code class="language-plaintext highlighter-rouge">--interlayer_color</code></td> <td style="text-align: center">black</td> <td style="text-align: right">Color of the interlayer lines.</td> </tr> </tbody> </table> <h4 id="additional-help-2">Additional Help</h4> <h5 id="input-file-help-1">Input File Help</h5> <p>The above parameters can be provided in an input file (specified with -i/–input_file) for the user’s convenience. Only one parameter is allowed per line, separate the parameters name and the chosen value(s) with an equal-to sign (=). For flags (i.e. verbose, [no]log, [no]backup), set the value to either ‘True’ or ‘False’. Lines may be commented out with a pound/hash/number sign (#). If a parameter can take multiple values (e.g. trajectory_file), you can either use separate entries for each value (e.g. put checkpoint_file = filename1, checkpoint_file = filename2, etc. on separate lines) or you can separate the filenames with a space in a single entry (e.g. checkpoint_file = filename1 filename2 …). An input file template is available in README.md.</p> <p>Heres an input file template for the <code class="language-plaintext highlighter-rouge">traj</code> subcommand to get you started:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># `Fibmap.py traj` input file template. Pass to -i/--input_file at commandline.
</span>
<span class="c1"># Input
</span><span class="n">checkpoint_file</span>        <span class="o">=</span> <span class="c1"># the name of the checkpoint file from a previous calc or map run.
</span>
<span class="c1"># Output
</span><span class="n">figure_file</span>            <span class="o">=</span> <span class="c1"># the name of the image file to save
</span><span class="n">backup</span>                 <span class="o">=</span> <span class="c1"># [True/False] make backups
</span><span class="n">log</span>                    <span class="o">=</span> <span class="c1"># [True/False] write a logfile
</span><span class="n">showfig</span>                <span class="o">=</span> <span class="c1"># [True/False] open the figure after saving
</span>
<span class="c1"># Figure Options
</span><span class="n">figure_width</span>           <span class="o">=</span> <span class="c1"># Width of Figure in inches
</span><span class="n">figure_height</span>          <span class="o">=</span> <span class="c1"># Height of Figure in inches
</span><span class="n">figure_dpi</span>             <span class="o">=</span> <span class="c1"># Figure resolution in dots per inch (dpi)
</span><span class="n">fontsize</span>               <span class="o">=</span> <span class="c1"># Size of font (font is Arial)
</span><span class="n">total_color</span>            <span class="o">=</span> <span class="c1"># Color of total plot lines
</span><span class="n">intralayer_color</span>       <span class="o">=</span> <span class="c1"># Color of intralayer plot lines
</span><span class="n">interlayer_color</span>       <span class="o">=</span> <span class="c1"># Color of interlayer plot lines
</span></code></pre></div></div> <h3 id="output-description">Output Description</h3> <h4 id="output-directory-map">Output Directory Map</h4> <pre><code class="language-mermaid">flowchart TB;
subgraph O[Output Directory]
  direction TB
  subgraph C[calc Output Files]
    subgraph CL[if --log]
      CLA[calc.log]
    end
    subgraph CA[always created]
      CAA[calc.cpt]
    end
    subgraph CC[--calctype dependent]
      direction LR
      subgraph CCS[if --saveraw]
          CCSA[unprocessed_hydrogen_bonds.npy]
          CCSB[unprocessed_salt_bridges.npy]
          CCSC[unprocessed_pistacking_interactions.npy]
      end
      subgraph CCA[always created for given --calctype]
        CCAA[processed_hydrogen_bonds.npy]
        CCAB[processed_salt_bridges.npy]
        CCAC[processed_pistacking_interactions.npy]
      end
    end
  end
  subgraph M[map Output Files]
    subgraph MA[always created]
      MAA[map.cpt]
      MAB[map_positions.npz]
      MAC[figure.png]
    end
    subgraph ML[if --log]
      MLA[map.log]
    end
  end
  subgraph T[traj Output Files]
    subgraph TA[always created]
      TAA[figure.png]
      TAB[traj_results.npz]
      TAC[traj.cpt]
    end
    subgraph TL[if --log]
      TLA[traj.log]
    end
  end
end

</code></pre> <h4 id="calc-output-file-descriptions">calc Output File Descriptions</h4> <table> <thead> <tr> <th style="text-align: left">FileName</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>calc_[calctype].cpt</strong></td> <td style="text-align: right">A checkpoint file to pick up the calculation from where it last left off. This file is always created. In order to avoid clashes with other <code class="language-plaintext highlighter-rouge">calc</code> checkpoint files, the file is named using the calctype (e.g. if <code class="language-plaintext highlighter-rouge">--calctype all</code> then the file is named calc_ALL.cpt). This file should be fed into <code class="language-plaintext highlighter-rouge">map</code> using the <code class="language-plaintext highlighter-rouge">--checkpoint_file</code> argument. This file can also be fed back into <code class="language-plaintext highlighter-rouge">calc</code> using the <code class="language-plaintext highlighter-rouge">--checkpoint_file</code> argument to pick up where it left off. If a file with this name already exists in the output directory this file will be backed up unless the <code class="language-plaintext highlighter-rouge">--nobackup</code> flag is used.</td> </tr> <tr> <td style="text-align: left"><strong>calc_[calctype].log</strong></td> <td style="text-align: right">A log file containing STDOUT. This file is created if the <code class="language-plaintext highlighter-rouge">--log</code> flag is used. In order to avoid clashes with other <code class="language-plaintext highlighter-rouge">calc</code> log files, the file is named using the calctype (e.g. if <code class="language-plaintext highlighter-rouge">--calctype all</code> then the file is named calc_ALL.log). If a file with this name already exists in the output directory this file will be backed up unless the <code class="language-plaintext highlighter-rouge">--nobackup</code> flag is used.</td> </tr> <tr> <td style="text-align: left"><strong>unprocessed_hydrogen_bonds.npy</strong></td> <td style="text-align: right">A .npy file containing a NumPy array of all hydrogen bonds calculated throughout a trajectory. This file is only written if the <code class="language-plaintext highlighter-rouge">--saveraw</code> flag is used. This is an array of floats with a row for each instance of a hydrogen bond. The columns contain the frame, donor atom index, hydrogen atom index, acceptor atom index, distance, and angle of a hydrogen bond. This is the output of the MDAnalysis hydrogen bond calculator, so for more help please see the <a href="https://docs.mdanalysis.org/stable/documentation_pages/analysis/hydrogenbonds.html" rel="external nofollow noopener" target="_blank">MDAnalysis Documentation</a>.</td> </tr> <tr> <td style="text-align: left"><strong>processed_hydrogen_bonds.npy</strong></td> <td style="text-align: right">A .npy file containing a NumPy array of each type of hydrogen bond and their probabilities. This is an array of floats with a row for each type of hydrogen bond. The columns contain the donor protofilament index (one-based), the donor residue index (one-based), the donor type (0=backone, 1=sidechain, 2=terminus), the acceptor protofilament index (one-based), the acceptor residue index (one-based), the acceptor type (0=backone, 1=sidechain, 2=terminus), Intralayer \(\langle N_{HB} \rangle\), Intralayer \(P(HB)\), Interlayer \(\langle N_{HB} \rangle\), and Interlayer \(P(HB)\).</td> </tr> <tr> <td style="text-align: left"><strong>unprocessed_salt_bridges.npy</strong></td> <td style="text-align: right">A .npy file containing a NumPy array of all salt bridges calculated throughout a trajectory. This file is only written if the <code class="language-plaintext highlighter-rouge">--saveraw</code> flag is used. This is an array of floats with a row for each instance of a salt bridge. The columns contain the frame, anionic layer index (one-based), anionic protofilament index (one-based), anionic residue index (one-based), cationic layer index (one-based), cationic protofilament index (one-based), cationic residue index (one-based), and the distance between the charged groups.</td> </tr> <tr> <td style="text-align: left"><strong>processed_salt_bridges.npy</strong></td> <td style="text-align: right">A .npy file containing a NumPy array of each type of salt bridge and their probabilities. This is an array of floats with a row for each type of salt bridge. The columns contain the anion protofilament index (one-based), the anion residue (one-based), the cation protofilament index (one-based), the cation residue index (one-based), intralayer \(P(SB)\), and interlayer \(P(SB)\).</td> </tr> <tr> <td style="text-align: left"><strong>unprocessed_pistacking_interactions.npy</strong></td> <td style="text-align: right">A .npy file containing a NumPy array of all pi stacking interactions calculated throughout a trajectory. This file is only written if the <code class="language-plaintext highlighter-rouge">--saveraw</code> flag is used. This is an array of floats with a row for each instance of a pi stacking interaction. The columns contain the frame, layer A index (one-based), protofilament A index (one-based), residue A index (one-based), layer B index (one-based), protofilament B index (one-based), residue B index (one-based), centroid-centroid distance, \(\gamma\) angle, \(\delta\) angle, \(\theta\) angle, and type (0=Sandwich, 1=parallel displaced, 2=Intermediate, 3=T-shaped).</td> </tr> <tr> <td style="text-align: left"><strong>processed_pistacking_interactions.npy</strong></td> <td style="text-align: right">A .npy file containing a NumPy array of each type of pi stacking interaction and their probabilities. This is an array of floats with a row for each type of pi stacking interaction. The columns contain Protofilament A index (one-based), Residue A index (one-based), Protofilament B index (one-based), Residue B index (one-based), Intralayer \(P(\mathrm{Total})\), Intralayer \(P(\mathrm{T-Shaped})\), Intralayer \(P(\mathrm{Intermediate})\), Intralayer \(P(\mathrm{Sandwich})\), Intralayer \(P(\mathrm{Parallel \text{ } Displaced})\), Interlayer \(P(\mathrm{Total})\), Interlayer \(P(\mathrm{T-Shaped})\), Interlayer \(P(\mathrm{Intermediate})\), Interlayer \(P(\mathrm{Sandwich})\), Interlayer \(P(\mathrm{Parallel \text{ } Displaced})\).</td> </tr> </tbody> </table> <p><em>NOTE: The NumPy arrays within .npy files can be opened with:</em> <code class="language-plaintext highlighter-rouge">array = numpy.load(FileName)</code></p> <h4 id="map-output-file-descriptions">map Output File Descriptions</h4> <table> <thead> <tr> <th style="text-align: left">File Name</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>map.cpt</strong></td> <td style="text-align: right">A checkpoint file to pick up the calculation from where it last left off. This file is always created. This file can be fed into <code class="language-plaintext highlighter-rouge">map</code> using the <code class="language-plaintext highlighter-rouge">--checkpoint_file</code> argument to skip the residue positions calculation. If a file with this name already exists in the output directory this file will be backed up unless the <code class="language-plaintext highlighter-rouge">--nobackup</code> flag is used.</td> </tr> <tr> <td style="text-align: left"><strong>map.log</strong></td> <td style="text-align: right">A log file containing STDOUT. This file is created if the <code class="language-plaintext highlighter-rouge">--log</code> flag is used. If a file with this name already exists in the output directory this file will be backed up unless the <code class="language-plaintext highlighter-rouge">--nobackup</code> flag is used.</td> </tr> <tr> <td style="text-align: left"><strong>map_positions.npz</strong></td> <td style="text-align: right">A file containing NumPy arrays with the residue position information so that the figure can be quickly regenerated without performing the position calculation again. This file is meant for internal use only, but further details are provided below (See <strong>About map_positions.npz</strong>).</td> </tr> <tr> <td style="text-align: left"><strong>figure.png</strong></td> <td style="text-align: right">The saved figure named according to the <code class="language-plaintext highlighter-rouge">-o/--figure_file</code> argument.</td> </tr> </tbody> </table> <h5 id="about-map_positionsnpz">About map_positions.npz</h5> <p>This .npz file contains the following four NumPy arrays:</p> <ul> <li> <p><strong>CA</strong>: Contains the \(\alpha\)-Carbon positions</p> <p>This is an array of shape (\(N_{\mathrm{protofilaments}}\), \(N_{\mathrm{residues}}\), \(2\)). For each residue in each chain, its position on the map is provided in Å.</p> </li> <li> <p><strong>SC</strong>: Contains the sidechain positions</p> <p>This is an array of shape (\(N_{\mathrm{protofilaments}}\), \(N_{\mathrm{residues}}\), \(2\)). For each residue in each chain, the center of mass of its sidechain on the plane of the map is provided in Å.</p> </li> <li> <p><strong>CT</strong>: Contains the C-terminus positions</p> <p>This is an array of shape (\(N_{\mathrm{protofilaments}}\), \(2\)). For each chain, the center of mass of the terminal atoms of its C-terminal residue on the plane of the map is provided in Å.</p> </li> <li> <p><strong>NT</strong>: Contains the N-terminus positions</p> <p>This is an array of shape (\(N_{\mathrm{protofilaments}}\), \(2\)). For each chain, the center of mass of the terminal atoms of its N-terminal residue on the plane of the map is provided in Å.</p> </li> </ul> <p>These arrays can be accessed using NumPy:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="nb">file</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="sh">"</span><span class="s">map_positions.npz</span><span class="sh">"</span><span class="p">)</span>
<span class="n">CA</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">CA</span><span class="sh">"</span><span class="p">]</span>
<span class="n">SC</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">SC</span><span class="sh">"</span><span class="p">]</span>
<span class="n">CT</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">CT</span><span class="sh">"</span><span class="p">]</span>
<span class="n">NT</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">NT</span><span class="sh">"</span><span class="p">]</span>
<span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># Need to close the file
</span></code></pre></div></div> <h4 id="traj-output-file-descriptions">traj Output File Descriptions</h4> <table> <thead> <tr> <th style="text-align: left">File Name</th> <th style="text-align: right">Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: left"><strong>traj.log</strong></td> <td style="text-align: right">A log file containing STDOUT. This file is created if the <code class="language-plaintext highlighter-rouge">--log</code> flag is used. If a file with this name already exists in the output directory this file will be backed up unless the <code class="language-plaintext highlighter-rouge">--nobackup</code> flag is used.</td> </tr> <tr> <td style="text-align: left"><strong>traj.cpt</strong></td> <td style="text-align: right">A checkpoint file that can be used to skip the calculation of previously calculated results for given interaction types.</td> </tr> <tr> <td style="text-align: left"><strong>traj_results.npz</strong></td> <td style="text-align: right">A file containing NumPy arrays with the results from the <code class="language-plaintext highlighter-rouge">traj</code> run. Further details are provided below (See <strong>About traj_results.npz</strong>).</td> </tr> <tr> <td style="text-align: left"><strong>figure.png</strong></td> <td style="text-align: right">The saved figure named according to the <code class="language-plaintext highlighter-rouge">-o/--figure_file</code> argument.</td> </tr> </tbody> </table> <h5 id="about-traj_resultsnpz">About traj_results.npz</h5> <p>This .npz file always contains the following array:</p> <ul> <li> <p><strong>times</strong>: Contains the times of each frame</p> <p>This is an array of shape (\(N_{\mathrm{frames}}\),). For each frame, its time is provided in units of picoseconds.</p> </li> </ul> <p>This .npz file will contain at least one of the following arrays:</p> <ul> <li> <p><strong>HB</strong>: Contains the number of hydrogen bonds per layer at each frame</p> <p>This is an array of shape (\(N_{\mathrm{frames}}\), \(3\)). For each frame, the average number of intralayer, interlayer, and total hydrogen bonds per layer are provided in columns 1, 2, and 3, respectively.</p> </li> <li> <p><strong>SB</strong>: Contains the number of salt bridges per layer at each frame</p> <p>This is an array of shape (\(N_{\mathrm{frames}}\), \(3\)). For each frame, the average number of intralayer, interlayer, and total salt bridges per layer are provided in columns 1, 2, and 3, respectively.</p> </li> <li> <p><strong>PI</strong>: Contains the number of pi stacking interactions per layer at each frame</p> <p>This is an array of shape (\(N_{\mathrm{frames}}\), \(3\)). For each frame, the average number of intralayer, interlayer, and total pi stacking interactions per layer are provided in columns 1, 2, and 3, respectively.</p> </li> </ul> <p>These arrays can be accessed using NumPy:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="nb">file</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">load</span><span class="p">(</span><span class="sh">"</span><span class="s">map_positions.npz</span><span class="sh">"</span><span class="p">)</span>
<span class="n">times</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">times</span><span class="sh">"</span><span class="p">]</span>
<span class="n">included_arrays</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="nb">file</span><span class="p">.</span><span class="nf">keys</span><span class="p">())</span>
<span class="k">if</span> <span class="sh">"</span><span class="s">HB</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">included_arrays</span><span class="p">:</span> <span class="c1"># Hydrogen Bond results are only calculated and saved if hb_unprocessed_results.npy was found
</span>    <span class="n">HB</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">HB</span><span class="sh">"</span><span class="p">]</span>
<span class="k">if</span> <span class="sh">"</span><span class="s">SB</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">included_arrays</span><span class="p">:</span> <span class="c1"># Salt Bridge results are only calculated and saved if sb_unprocessed_results.npy was found
</span>    <span class="n">SB</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">SB</span><span class="sh">"</span><span class="p">]</span>
<span class="k">if</span> <span class="sh">"</span><span class="s">PI</span><span class="sh">"</span> <span class="ow">in</span> <span class="n">included_arrays</span><span class="p">:</span> <span class="c1"># Pi Stacking Interaction results are only calculated and saved if pi_unprocessed_results.npy was found
</span>    <span class="n">PI</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="sh">"</span><span class="s">PI</span><span class="sh">"</span><span class="p">]</span>
<span class="nb">file</span><span class="p">.</span><span class="nf">close</span><span class="p">()</span> <span class="c1"># Need to close the file
</span></code></pre></div></div> <h2 id="tutorials">Tutorials</h2> <p>Before starting download all of the necessary files for the following two tutorials <a href="/assets/zip/tutorials.zip" download="" target="_blank" rel="noopener noreferrer">here</a>.</p> <h3 id="tutorial-1-creating-a-fibmap-from-a-pdb">Tutorial 1: Creating a FibMap from a PDB</h3> <p><strong>Step 1: Obtain the PDB and reformat it</strong></p> <ol> <li>Obtain the PDB (<a href="https://www.rcsb.org/structure/6MST" rel="external nofollow noopener" target="_blank">PDB 6MST</a>) from the <a href="https://www.rcsb.org/" rel="external nofollow noopener" target="_blank">RCSB PDB Protein Data Bank</a>, from the downloaded zip, or go directly to <a href="https://www.charmm-gui.org/" rel="external nofollow noopener" target="_blank">CHARMM-GUI</a>.</li> <li>Go to the <a href="https://www.charmm-gui.org/?doc=input/pdbreader" rel="external nofollow noopener" target="_blank">CHARMM-GUI PDB Reader &amp; Manipulator</a>. We want to convert the PDB to include charge information and to have atom and residue names matching the CHARMM36 forcefield so that we don’t have to play around with the input parameters too much. Here, if you have the PDB, you can upload it with “PDB format: PDB”. If you don’t have the PDB, type “6MST” into the “Download PDB File:” box with “Download Source: RCSB”. Leave the “Check/Correct PDB Format” box unchecked and then click “Next Step: Select Model/Chain”.</li> <li>Leave everything on this page as is. Click “Next Step: Manipulate PDB”.</li> <li>Under “Terminal Group Patching” change the “Last” patch for each segment to “CNEU”, then click “Next Step: Generate PDB”. <em>NOTE: If you’re trying to do this for some other fibril, you should consider your terminal patches carefully. If there are not any missing residues, you should probably leave them as is. If there are missing residues and you leave them charged it might impact the salt bridge results.</em> </li> <li>Download and unzip the results: <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>mkdir charmm-gui &amp;&amp; tar -zxvf charmm-gui.tgz -C charmm-gui --strip-components 1
</code></pre></div> </div> <p><em>NOTE: The folder that is unpacked from charmm-gui.tgz typically has the JOB ID in the name (charmm-gui-[JOB ID]/). For the sake of this tutorial, the above command will automatically rename the folder “charmm-gui”. If you want to keep the JOB ID in the folder name you can simply use <code class="language-plaintext highlighter-rouge">tar -zxvf charmm-gui.tgz</code>.</em></p> </li> <li> <p>Use correct_pdb.py in the helper_programs subdirectory to reorder the topology: <em>NOTE: This program is somewhat crude, but should work for most systems. If not, you can use it as a guide for using MDAnalysis to reorder a topology file. For additional help, check out <a href="https://userguide.mdanalysis.org/stable/examples/constructing_universe.html" rel="external nofollow noopener" target="_blank">this page</a> of the MDAnalysis user guide.</em> <em>NOTE: This may not be necessary for every fibril. Open the pdb outputted by CHARMM-GUI in VMD or some other molecular visualization program and make sure that the segments in the PDB appear in the correct order (See <strong><a href="#additional-help">Usage: calc: Additional Help:</a> Topology File Setup</strong> for more information).</em></p> <ul> <li>Feed step1_pdbreader.pdb and step1_pdbreader.psf to correct_pdb.py. These files can be found among the output of CHARMM-GUI. <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> python correct_pdb.py -i charmm-gui/step1_pdbreader.pdb -c charmm-gui/step1_pdbreader.psf -o prepared --makefig
</code></pre></div> </div> </li> <li>A figure will open showing the positions of each segment from three perspectives. Use this figure to determine the proper order of the segments. Write these down, or open the figure manually: it was saved to prepared_segment_locs.png.</li> </ul> </li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/prepared_segment_locs-480.webp 480w,/assets/img/fibmap/prepared_segment_locs-800.webp 800w,/assets/img/fibmap/prepared_segment_locs-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/prepared_segment_locs.png" class="img-fluid rounded z-depth-1" width="75%" height="auto" title="Segment Locations Tutorial 1" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 11: Segment location figure from correct_pdb.py for tutorial 1. </div> <ul> <li>Follow the instructions outputted by the program. You should end up entering the following lines and then hitting [Enter] again: <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code> PROA PROC PROD PROL PROH PROJ
 PROB PROE PROF PROG PROI PROK
</code></pre></div> </div> </li> </ul> <p><strong>Step 2: Run FibMap</strong></p> <ol> <li>Run the calc step of FibMap using calc_input.inp: <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>python FibMap.py calc -i calc_input.inp
</code></pre></div> </div> </li> <li>Run the map step of FibMap using map_input.inp: <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>python FibMap.py map -i map_input.inp
</code></pre></div> </div> </li> </ol> <p><strong>The result should look like this:</strong></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/Tutorial1_FibMap-480.webp 480w,/assets/img/fibmap/Tutorial1_FibMap-800.webp 800w,/assets/img/fibmap/Tutorial1_FibMap-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/Tutorial1_FibMap.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Result Tutorial 1" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 12: Output for Tutorial 1. </div> <h3 id="tutorial-2-creating-a-fibmap-from-an-md-trajectory">Tutorial 2: Creating a FibMap from an MD Trajectory</h3> <p><strong>Step 1: Reorder your topology and then run your simulation</strong></p> <p><em>NOTE: This is not a tutorial on running an MD simulation, because such tutorials have been written by many others (personally, I recommend <a href="http://www.mdtutorials.com/gmx/index.html" rel="external nofollow noopener" target="_blank">Justin Lemkul’s GROMACS tutorials</a> as a starting point). I recommend, however, that you reorder the segments in your topology <strong>before</strong> running your simulations, as it is much more difficult to do after you have the trajectory. The helper program, correct_pdb.py (found in the helper_programs subdirectory), can help you do this, but it will not work for a trajectory.</em></p> <p>A sample trajectory with its topology file is provided in the tutorials/tutorial2 subdirectory. You will use top.tpr as the topology file (it contains all of the necessary information) and traj.xtc as your trajectory file for FibMap. I’ve also included top.gro in case you want to view the trajectory in <a href="https://www.ks.uiuc.edu/Research/vmd/" rel="external nofollow noopener" target="_blank">VMD</a>. This is a simulation of a 12 layer hSAA fibril derived from PDB 6MST. Note that this trajectory only contains 101 frames and as such will likely not produce a publishable result. For your own system, you should use many more frames from more than one trajectory.</p> <p><strong>Step 2: Run FibMap</strong></p> <ol> <li>Run the calc step of FibMap using calc_input.inp: <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>python FibMap.py calc -i calc_input.inp
</code></pre></div> </div> </li> <li>Run the map step of FibMap using map_input.inp: <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>python FibMap.py map -i map_input.inp
</code></pre></div> </div> </li> </ol> <p><strong>The result should look like this:</strong></p> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/Tutorial2_FibMap-480.webp 480w,/assets/img/fibmap/Tutorial2_FibMap-800.webp 800w,/assets/img/fibmap/Tutorial2_FibMap-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/Tutorial2_FibMap.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Result Tutorial 2" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 13: Map output for Tutorial 2. </div> <ol> <li>Run the traj step of FibMap using traj_input.inp <div class="language-plaintext highlighter-rouge"> <div class="highlight"><pre class="highlight"><code>python FibMap.py traj -i traj_input.inp
</code></pre></div> </div> <p><strong>The result should look like this:</strong></p> </li> </ol> <div class="row"> <div class="col-sm mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/fibmap/Tutorial2_Traj-480.webp 480w,/assets/img/fibmap/Tutorial2_Traj-800.webp 800w,/assets/img/fibmap/Tutorial2_Traj-1400.webp 1400w," sizes="95vw" type="image/webp"></source> <img src="/assets/img/fibmap/Tutorial2_Traj.png" class="img-fluid rounded z-depth-1" width="75%" height="auto" title="Trajectory Result Tutorial 2" data-zoomable="" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Figure 14: Trajectory analysis output for Tutorial 2. The figure shows the number of each type of interaction per layer for each frame. </div> <h2 id="references">References</h2> <ol> <li>Fowler, D. M.; Koulov, A. V.; Alory-Jost, C.; Marks, M. S.; Balch, W. E.; Kelly, J. W. <em>PLoS biology</em> <strong>2006</strong>, <em>4</em>, e6. https://doi.org/10.1371/journal.pbio.0040006</li> <li>Sawaya, M. R.; Hughes, M. P.; Rodriguez, J. A.; Riek, R.; Eisenberg, D. S. <em>Cell</em> <strong>2021</strong>, <em>184</em>, 4857–4873. https://doi.org/10.1016/j.cell.2021.08.013</li> <li>Benson, M. D.; Buxbaum, J. N.; Eisenberg, D. S.; Merlini, G.; Saraiva, M. J.; Sekijima, Y.; Sipe, J. D.; Westermark, P. <em>Amyloid</em> <strong>2018</strong>, <em>25</em>, 215–219. https://doi.org/10.1080/13506129.2018.1549825</li> <li>Fitzpatrick, A. W.; Falcon, B.; He, S.; Murzin, A. G.; Murshudov, G.; Garringer, H. J.; Crowther, R. A.; Ghetti, B.; Goedert, M.; Scheres, S. H. <em>Nature</em> <strong>2017</strong>, <em>547</em>, 185–190. https://doi.org/10.1038/nature23002</li> <li>Cao, Q.; Boyer, D. R.; Sawaya, M. R.; Ge, P.; Eisenberg, D. S. <em>Nature structural &amp; molecular biology</em> <strong>2019</strong>, <em>26</em>, 619–627. https://doi.org/10.1038/s41594-019-0248-4</li> <li>Li, B.; Ge, P.; Murray, K. A.; Sheth, P.; Zhang, M.; Nair, G.; Sawaya, M. R.; Shin, W. S.; Boyer, D. R.; Ye, S., et al. <em>Nature communications</em> <strong>2018</strong>, <em>9</em>, 1–10. https://doi.org/10.1038/s41467-018-05971-2</li> <li>Zhang, W.; Falcon, B.; Murzin, A. G.; Fan, J.; Crowther, R. A.; Goedert, M.; Scheres, S. H. Elife 2019, 8, e43584. https://doi.org/10.7554/eLife.43584</li> <li>Guerrero-Ferreira, R.; Taylor, N. M.; Arteni, A.-A.; Kumari, P.; Mona, D.; Ringler, P.; Britschgi, M.; Lauer, M. E.; Makky, A.; Verasdonck, J., et al. <em>Elife</em> <strong>2019</strong>, <em>8</em>, e48907. https://doi.org/10.7554/eLife.48907</li> <li>Boyer, D. R.; Li, B.; Sun, C.; Fan, W.; Sawaya, M. R.; Jiang, L.; Eisenberg, D. S. <em>Nature structural &amp; molecular biology</em> <strong>2019</strong>, <em>26</em>, 1044–1052. https://doi.org/10.1038/s41594-019-0322-y</li> <li>Bansal, A.; Schmidt, M.; Rennegarbe, M.; Haupt, C.; Liberta, F.; Stecher, S.; Puscalau-Girtu, I.; Biedermann, A.; F ̈andrich, M. <em>Nature communications</em> <strong>2021</strong>, <em>12</em>, 1–9. https://doi.org/10.1038/s41467-021-21129-z</li> <li>Humphrey, W.; Dalke, A.; Schulten, K. VMD: visual molecular dynamics. <em>Journal of molecular graphics</em> <strong>1996</strong>, <em>14</em>, 33–38. https://doi.org/10.1016/0263-7855(96)00018-5</li> <li>Liberta, F.; Loerch, S.; Rennegarbe, M.; Schierhorn, A.; Westermark, P.; Westermark, G. T.; Hazenberg, B. P.; Grigorieff, N.; F ̈andrich, M.; Schmidt, M. <em>Nature communications</em> <strong>2019</strong>, <em>10</em>, 1–10. https://doi.org/10.1038/s41467-019-09033-z</li> <li>Zhao, Y., Li, J., Gu, H. et al. <em>Interdiscip Sci Comput Life Sci</em> <strong>2015</strong>, <em>7</em>, 211–220. https://doi.org/10.1007/s12539-015-0263-z</li> </ol> <h2 id="license">License</h2> <p>FibMap is distributed under the MIT license:</p> <p>MIT License</p> <p>Copyright © 2023 Conor B. Abraham</p> <p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the “Software”), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p> <p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p> <p>THE SOFTWARE IS PROVIDED “AS IS”, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p> </div> </article> </div> </div> </div> </div> <footer class="sticky-bottom mt-5" role="contentinfo"> <div class="container"> © Copyright 2024 Conor B. Abraham. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/mermaid@10.7.0/dist/mermaid.min.js" integrity="sha256-TtLOdUA8mstPoO6sGvHIGx2ceXrrX4KgIItO06XOn8A=" crossorigin="anonymous"></script> <script>let theme=determineComputedTheme();document.onreadystatechange=(()=>{"complete"===document.readyState&&(document.querySelectorAll("pre>code.language-mermaid").forEach(e=>{const t=e.textContent,d=e.parentElement;d.classList.add("unloaded");let n=document.createElement("pre");n.classList.add("mermaid");const a=document.createTextNode(t);n.appendChild(a),d.after(n)}),mermaid.initialize({theme:theme}),"undefined"!=typeof d3&&window.addEventListener("load",function(){d3.selectAll(".mermaid svg").each(function(){var e=d3.select(this);e.html("<g>"+e.html()+"</g>");var t=e.select("g"),d=d3.zoom().on("zoom",function(e){t.attr("transform",e.transform)});e.call(d)})}))});</script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script defer src="/assets/js/bootstrap-toc.min.js?c82ff4de8b0955d6ff14f5b05eed7eb6"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?b7816bd189846d29eded8745f9c4cf77"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>